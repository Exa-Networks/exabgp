option:file:conf-flow.conf
# flow source-ipv4 10.0.0.1/32 rd 65535:65536 extended-community discard
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0047:02:000000304001010040020040050400000064C010088006000000000000800E1400018600000E0000FFFF0001000002200A000001
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":9225060886715039744,"string":"rate-limit:0"}]},"announce":{"ipv4 flow-vpn":{"no-nexthop":[{"source-ipv4":["10.0.0.1/32"],"rd":"65535:65536","string":"flow source-ipv4 10.0.0.1/32 rd 65535:65536"}]}}}}}}

# flow source-ipv4 10.0.0.2/32 next-hop 1.2.3.4 extended-community copy-to-nexthop
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0043:02:0000002C4001010040020040050400000064C010080800000000000001800E100001850401020304000602200A000002
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":576460752303423489,"string":"copy-to-nexthop"}]},"announce":{"ipv4 flow":{"1.2.3.4":[{"source-ipv4":["10.0.0.2/32"],"next-hop":"1.2.3.4","string":"flow source-ipv4 10.0.0.2/32 next-hop 1.2.3.4"}]}}}}}}

# flow destination-ipv4 10.0.0.2/32 source-ipv4 10.0.0.1/32 protocol =TCP destination-port =3128 community [ 30740:0 30740:30740 ] extended-community discard
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0057:02:000000404001010040020040050400000064C008087814000078147814C010088006000000000000800E1900018500001301200A00000202200A00000103810605910C38
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"community":[[30740,0],[30740,30740]],"extended-community":[{"value":9225060886715039744,"string":"rate-limit:0"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"destination-ipv4":["10.0.0.2/32"],"source-ipv4":["10.0.0.1/32"],"protocol":["=tcp"],"destination-port":["=3128"],"string":"flow destination-ipv4 10.0.0.2/32 source-ipv4 10.0.0.1/32 protocol =tcp destination-port =3128"}]}}}}}}

# flow fragment =last-fragment extended-community action sample-terminal
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:003C:02:000000254001010040020040050400000064C010088007000000000003800E090001850000030C8008
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":9225342361691750403,"string":"action sample-terminal"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"fragment":["last-fragment"],"string":"flow fragment last-fragment"}]}}}}}}
# used to be slightly differently encoded with the fragment - keeping just in case
# 1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:003C:02:000000254001010040020040050400000064C010088007000000000003800E090001850000030C8108

# flow source-ipv4 10.0.0.0/24 protocol =TCP destination-port =3128 extended-community rate-limit 9600
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0045:02:0000002E4001010040020040050400000064C010088006000046160000800E1200018500000C02180A000003810605910C38
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":9225060887890886656,"string":"rate-limit:9600"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"source-ipv4":["10.0.0.0/24"],"protocol":["=tcp"],"destination-port":["=3128"],"string":"flow source-ipv4 10.0.0.0/24 protocol =tcp destination-port =3128"}]}}}}}}

# flow destination-ipv6 2a02:b80:15::7aca:39ff:feae:a87a/128/0 source-ipv6 ::1/128/120 next-header =UDP traffic-class =101 flow-label =2013 extended-community discard
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0069:02:000000524001010040020040050400000064C010088006000000000000800E360002850000300180002A020B80001500007ACA39FFFEAEA87A028078000000000000000000000000000000010381110B81650D9107DD
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":9225060886715039744,"string":"rate-limit:0"}]},"announce":{"ipv6 flow":{"no-nexthop":[{"destination-ipv6":["2a02:b80:15:0:7aca:39ff:feae:a87a/128/0"],"source-ipv6":["::1/128/120"],"next-header":["=udp"],"traffic-class":["=101"],"flow-label":["=2013"],"string":"flow destination-ipv6 2a02:b80:15:0:7aca:39ff:feae:a87a/128/0 source-ipv6 ::1/128/120 next-header =udp traffic-class =101 flow-label =2013"}]}}}}}}

# flow packet-length >200&<300 >400&<500 extended-community mark 10
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0045:02:0000002E4001010040020040050400000064C01008800900000000000A800E1200018500000C0A02C854012C120190D401F4
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":9225905311645171722,"string":"mark 10"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"packet-length":[">200&<300",">400&<500"],"string":"flow packet-length [ >200&<300 >400&<500 ]"}]}}}}}}

# flow route-distinguisher 65535:65536 source-ipv4 10.0.0.3/32 next-hop 5.6.7.8 extended-community redirect-to-nexthop
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:004B:02:000000344001010040020040050400000064C010080800000000000000800E180001860405060708000E0000FFFF0001000002200A000003
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":576460752303423488,"string":"redirect-to-nexthop"}]},"announce":{"ipv4 flow-vpn":{"5.6.7.8":[{"source-ipv4":["10.0.0.3/32"],"rd":"65535:65536","next-hop":"5.6.7.8","string":"flow source-ipv4 10.0.0.3/32 rd 65535:65536 next-hop 5.6.7.8"}]}}}}}}

# flow destination-ipv4 192.168.0.1/32 next-hop 1.2.3.4 extended-community redirect-to-nexthop
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0043:02:0000002C4001010040020040050400000064C010080800000000000000800E10000185040102030400060120C0A80001
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":576460752303423488,"string":"redirect-to-nexthop"}]},"announce":{"ipv4 flow":{"1.2.3.4":[{"destination-ipv4":["192.168.0.1/32"],"next-hop":"1.2.3.4","string":"flow destination-ipv4 192.168.0.1/32 next-hop 1.2.3.4"}]}}}}}}

# flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.2/32 protocol [ =udp =tcp ] port [ =80 =8080 ] destination-port [ >8080&<8088 =3128 ] source-port >1024 origin igp local-preference 100 extended-community redirect:258:33756718
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:005E:02:000000474001010040020040050400000064C01008800801020203162E800E2B0001850000250120C0A8000102200A0000020301118106040150911F9005121F90541F98910C3806920400
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":9225624944803780142,"string":"redirect:258:33756718"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"destination-ipv4":["192.168.0.1/32"],"source-ipv4":["10.0.0.2/32"],"protocol":["=udp","=tcp"],"port":["=80","=8080"],"destination-port":[">8080&<8088","=3128"],"source-port":[">1024"],"string":"flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.2/32 protocol [ =udp =tcp ] port [ =80 =8080 ] destination-port [ >8080&<8088 =3128 ] source-port >1024"}]}}}}}}

# flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.2/32 protocol =UDP =TCP port =80 =8080 destination-port >8080&<8088 =3128 source-port >1024 extended-community redirect 65500:12345
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:005E:02:000000474001010040020040050400000064C010088008FFDC00003039800E2B0001850000250120C0A8000102200A0000090301118106040150911F9005121F90541F98910C3806920400
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":9225905157026361401,"string":"redirect:65500:12345"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"destination-ipv4":["192.168.0.1/32"],"source-ipv4":["10.0.0.9/32"],"protocol":["=udp","=tcp"],"port":["=80","=8080"],"destination-port":[">8080&<8088","=3128"],"source-port":[">1024"],"string":"flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.9/32 protocol [ =udp =tcp ] port [ =80 =8080 ] destination-port [ >8080&<8088 =3128 ] source-port >1024"}]}}}}}}

# flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.10/32 protocol !=TCP port !=0 destination-port !=443 source-port !=80 !=8080 extended-community discard
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0055:02:0000003E4001010040020040050400000064C010088006000000000000800E2200018500001C0120C0A8000102200A00000A038606048600059601BB060650961F90
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":9225060886715039744,"string":"rate-limit:0"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"destination-ipv4":["192.168.0.1/32"],"source-ipv4":["10.0.0.10/32"],"protocol":["!=tcp"],"port":["!=0"],"destination-port":["!=443"],"source-port":["!=80","!=8080"],"string":"flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.10/32 protocol !=tcp port !=0 destination-port !=443 source-port [ !=80 !=8080 ]"}]}}}}}}

# flow source-ipv4 10.0.0.1/32 destination-ipv4 10.0.0.2/32 destination-port =3128 protocol tcp tcp-flags SYN RST&FIN&!=push extended-community discard 
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0055:02:0000003E4001010040020040050400000064C010088006000000000000800E2200018500001C01200A00000202200A00000103810605910C3809000200044001C308
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":1,"peer":1},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":9225060886715039744,"string":"rate-limit:0"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"destination-ipv4":["10.0.0.2/32"],"source-ipv4":["10.0.0.1/32"],"protocol":["=tcp"],"destination-port":["=3128"],"tcp-flags":["syn","rst&fin&!=push"],"string":"flow destination-ipv4 10.0.0.2/32 source-ipv4 10.0.0.1/32 protocol =tcp destination-port =3128 tcp-flags [ syn rst&fin&!=push ]"}]}}}}}}

# EOR
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:001E02:00000007900F0003000185
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:001E02:00000007900F0003000186
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:001E02:00000007900F0003000285

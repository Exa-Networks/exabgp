option:file:conf-flow-redirect.conf
1:cmd:announce ipv4 flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.1/32 protocol [ =tcp =udp ] port [ =80 =8080 ] destination-port [ >8080&<8088 =3128 ] source-port >1024 icmp-type [ =unreachable =echo-request =echo-reply ] icmp-code [ =1 =0 ] tcp-flags [ urg rst ] packet-length [ >200&<300 >400&<500 ] dscp [ =10 =20 ] fragment [ first-fragment last-fragment ] extended-community [origin:2345:6.7.8.9 origin:2.3.4.5:6789 redirect:65500:12345] community [30740:0 30740:30740]
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:00A0:02:000000894001010040020040050400000064C008087814000078147814C0101800030929060708090103020304051A858008FFDC00003039800E5200018500004C0120C0A8000102200A0000010301068111040150911F9005121F90541F98910C380692040007010301088100080101810009002080040A02C854012C120190D401F40B010A81140C00048008
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":65500,"peer":65500},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"community":[[30740,0],[30740,30740]],"extended-community":[{"value":854496729565193,"string":"origin:2345:6.7.8.9"},{"value":72904230943660677,"string":"origin:2.3.4.5:6789"},{"value":9225905157026361401,"string":"redirect:65500:12345"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"destination-ipv4":["192.168.0.1/32"],"source-ipv4":["10.0.0.1/32"],"protocol":["=tcp","=udp"],"port":["=80","=8080"],"destination-port":[">8080&<8088","=3128"],"source-port":[">1024"],"icmp-type":["=unreachable","=echo-request","=echo-reply"],"icmp-code":["=1","=0"],"tcp-flags":["urg","rst"],"packet-length":[">200&<300",">400&<500"],"dscp":["=10","=20"],"fragment":["first-fragment","last-fragment"],"string":"flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.1/32 protocol [ =tcp =udp ] port [ =80 =8080 ] destination-port [ >8080&<8088 =3128 ] source-port >1024 icmp-type [ =unreachable =echo-request =echo-reply ] icmp-code [ =1 =0 ] tcp-flags [ urg rst ] packet-length [ >200&<300 >400&<500 ] dscp [ =10 =20 ] fragment [ first-fragment last-fragment ]"}]}}}}}}
1:cmd:announce ipv4 flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.1/32 extended-community [origin:2345:6.7.8.9 origin:2.3.4.5:6789 redirect:65500:12345] community [30740:0 30740:30740]
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0060:02:000000494001010040020040050400000064C008087814000078147814C0101800030929060708090103020304051A858008FFDC00003039800E1200018500000C0120C0A8000102200A000001
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":65500,"peer":65500},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"community":[[30740,0],[30740,30740]],"extended-community":[{"value":854496729565193,"string":"origin:2345:6.7.8.9"},{"value":72904230943660677,"string":"origin:2.3.4.5:6789"},{"value":9225905157026361401,"string":"redirect:65500:12345"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"destination-ipv4":["192.168.0.1/32"],"source-ipv4":["10.0.0.1/32"],"string":"flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.1/32"}]}}}}}}
1:cmd:announce ipv4 flow destination-ipv4 118.184.176.6/32 extended-community [rate-limit:1250000000 redirect:65001:119]
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0047:02:000000304001010040020040050400000064C01010800600004E9502F98008FDE900000077800E0C000185000006012076B8B006
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":65500,"peer":65500},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":9225060888033428217,"string":"rate-limit:1250000000"},{"value":9225903013837668471,"string":"redirect:65001:119"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"destination-ipv4":["118.184.176.6/32"],"string":"flow destination-ipv4 118.184.176.6/32"}]}}}}}}
1:cmd:announce ipv4 flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.1/32 extended-community [redirect-to-nexthop-ietf 1.2.3.4]
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0045:02:0000002E4001010040020040050400000064C01008010C010203040000800E1200018500000C0120C0A8000102200A000001
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":65500,"peer":65500},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"extended-community":[{"value":75436401910611968,"string":"redirect-to-nexthop-ietf 1.2.3.4"}]},"announce":{"ipv4 flow":{"no-nexthop":[{"destination-ipv4":["192.168.0.1/32"],"source-ipv4":["10.0.0.1/32"],"string":"flow destination-ipv4 192.168.0.1/32 source-ipv4 10.0.0.1/32"}]}}}}}}
1:cmd:announce ipv4 flow destination-ipv4 192.168.0.2/32 source-ipv4 10.0.0.1/32 attribute [0x19 0xc0 0x000c2a020b800000000100000000000000010000]
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:0051:02:0000003A4001010040020040050400000064C01914000C2A020B800000000100000000000000010000800E1200018500000C0120C0A8000202200A000001
1:json:{"exabgp":"6.0.0","type":"update","neighbor":{"address":{"local":"127.0.0.1","peer":"127.0.0.1"},"asn":{"local":65500,"peer":65500},"direction":"in","message":{"update":{"attribute":{"origin":"igp","local-preference":100,"attribute-0x19-0xC0":"redirect-to-nexthop-ietf 2a02:b80:0:1::1"},"announce":{"ipv4 flow":{"no-nexthop":[{"destination-ipv4":["192.168.0.2/32"],"source-ipv4":["10.0.0.1/32"],"string":"flow destination-ipv4 192.168.0.2/32 source-ipv4 10.0.0.1/32"}]}}}}}}

# EOR
1:cmd:announce eor ipv4 flow
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:001E02:00000007900F0003000185
1:cmd:announce eor ipv4 flow-vpn
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:001E02:00000007900F0003000186
1:cmd:announce eor ipv6 flow
1:raw:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:001E02:00000007900F0003000285
